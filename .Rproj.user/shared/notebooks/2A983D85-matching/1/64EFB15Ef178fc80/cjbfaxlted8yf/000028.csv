"0","#|label: matching"
"0",""
"0","treatment <- poli$treat_out"
"0","outcome <- poli$code_some_response_given"
"0",""
"0","# Step 1"
"0","match <- matchit(code_some_response_given ~ treat_out,"
"0","                 data = poli,"
"0","                 method = ""nearest"","
"0","                 distance = ""Mahalanobis"","
"0","                 estimand = ""ATT"","
"0","                 ratio = 1,"
"0","                 replace = T)"
"0",""
"0","match.data(match) -> matched_df"
"0",""
"0","lm_mod <- lm(treat_out ~ code_some_response_given,"
"0","             data = matched_df,"
"0","             weights = weights)"
"0",""
"0","summary(lm_mod)"
"1","
Call:
"
"1",""
"1","lm(formula = treat_out ~ code_some_response_given, data = matched_df, 
    weights = weights)"
"1",""
"1","

"
"1","Weighted "
"1",""
"1","Residuals:
"
"1","    Min "
"1","     1Q "
"1"," Median "
"1","     3Q "
"1","    Max "
"1","
"
"1","-0.3902 "
"1","-0.3395 "
"1","-0.3395 "
"1"," 0.6605 "
"1"," 0.6605 "
"1","
"
"1","
Coefficients:
"
"1","                        "
"1","   Estimate"
"1"," Std. Error"
"1"," t value"
"1"," Pr(>|t|)"
"1","
(Intercept)             "
"1","  3.395e-01"
"1","  3.350e-01"
"1","   1.014"
"1","    0.311"
"1","
code_some_response_given"
"1"," -2.244e-13"
"1","  3.351e-01"
"1","   0.000"
"1","    1.000"
"1","
"
"1","
Residual standard error:"
"1"," "
"1","0.4738"
"1"," "
"1","on"
"1"," "
"1","2365"
"1"," "
"1","degrees of freedom"
"1","
"
"1","Multiple R-squared: "
"1"," "
"1","1.024e-28"
"1",",	Adjusted R-squared: "
"1"," "
"1","-0.0004228"
"1"," "
"1","
F-statistic:"
"1"," "
"1","2.421e-25"
"1"," "
"1","on"
"1"," "
"1","1"
"1"," "
"1","and"
"1"," "
"1","2365"
"1"," "
"1","DF,  p-value:"
"1"," "
"1","1"
"1","
"
"1","
"
"0","att_est <- coef(lm_mod)[""code_some_response_given""]"
"0","print(att_est)"
"1","code_some_response_given "
"1","
"
"1","           -2.243825e-13 "
"1","
"
"0","summary(match)$nn # number of matched"
"1","             "
"1","     Control"
"1"," Treated"
"1","
All (ESS)    "
"1"," 3228.000000"
"1","    2365"
"1","
All          "
"1"," 3228.000000"
"1","    2365"
"1","
Matched (ESS)"
"1","    1.813243"
"1","    2365"
"1","
Matched      "
"1","    2.000000"
"1","    2365"
"1","
Unmatched    "
"1"," 3226.000000"
"1","       0"
"1","
Discarded    "
"1","    0.000000"
"1","       0"
"1","
"
"0","print(round(att_est, 2)) # causal estimate"
"1","code_some_response_given "
"1","
"
"1","                       0 "
"1","
"
